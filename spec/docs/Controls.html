<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Controls</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">ventilator-spec-0.1.0.0</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Controls</p></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:Controls">Controls</a></li><li class="src short"><a href="#v:controls">controls</a> :: <a href="Controls.html#t:Controls" title="Controls">Controls</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:Mode">Mode</a> = <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a></li><li class="src short"><a href="#v:mode">mode</a> :: Stream <a href="Controls.html#t:Mode" title="Controls">Mode</a></li><li class="src short"><a href="#v:mCMV">mCMV</a> :: Stream <a href="Controls.html#t:Mode" title="Controls">Mode</a></li><li class="src short"><a href="#v:mSIMV">mSIMV</a> :: Stream <a href="Controls.html#t:Mode" title="Controls">Mode</a></li><li class="src short"><a href="#v:button_start_high_edge">button_start_high_edge</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:button_stop_high_edge">button_stop_high_edge</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:error_controls">error_controls</a> :: <a href="Controls.html#t:Controls" title="Controls">Controls</a> -&gt; Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:bpm_limited">bpm_limited</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a></li><li class="src short"><a href="#v:ie_inhale_limited">ie_inhale_limited</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a></li><li class="src short"><a href="#v:ie_exhale_limited">ie_exhale_limited</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a></li><li class="src short"><a href="#v:volume_limit_limited">volume_limit_limited</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a></li><li class="src short"><a href="#v:pressure_limit_limited">pressure_limit_limited</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a></li><li class="src short"><a href="#v:peep_limited">peep_limited</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a></li><li class="src short"><a href="#v:cmv_mode">cmv_mode</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:cmvVC">cmvVC</a> :: <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:cmvPC">cmvPC</a> :: <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:cmv_volume_goal_limited">cmv_volume_goal_limited</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a></li><li class="src short"><a href="#v:cmv_pressure_goal_limited">cmv_pressure_goal_limited</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a></li><li class="src short"><a href="#v:global_max_flow">global_max_flow</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a></li><li class="src short"><a href="#v:global_volume_min">global_volume_min</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a></li><li class="src short"><a href="#v:global_volume_max">global_volume_max</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a></li><li class="src short"><a href="#v:global_pressure_min">global_pressure_min</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a></li><li class="src short"><a href="#v:global_pressure_max">global_pressure_max</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Controls" class="def">Controls</a> <a href="#t:Controls" class="selflink">#</a></p><div class="doc"><p>Organizational record for all operator control signals (user input).</p></div></div><div class="top"><p class="src"><a id="v:controls" class="def">controls</a> :: <a href="Controls.html#t:Controls" title="Controls">Controls</a> <a href="#v:controls" class="selflink">#</a></p><div class="doc"><p>All controls are external (not derived).</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Mode" class="def">Mode</a> = <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a> <a href="#t:Mode" class="selflink">#</a></p><div class="doc"><p><a href="Macro.html">Macro</a> ventilation mode (CMV, SIMV, etc.)</p></div></div><div class="top"><p class="src"><a id="v:mode" class="def">mode</a> :: Stream <a href="Controls.html#t:Mode" title="Controls">Mode</a> <a href="#v:mode" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:mCMV" class="def">mCMV</a> :: Stream <a href="Controls.html#t:Mode" title="Controls">Mode</a> <a href="#v:mCMV" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:mSIMV" class="def">mSIMV</a> :: Stream <a href="Controls.html#t:Mode" title="Controls">Mode</a> <a href="#v:mSIMV" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:button_start_high_edge" class="def">button_start_high_edge</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:button_start_high_edge" class="selflink">#</a></p><div class="doc"><p>True whenever the start button becomes pressed (changed, high leading
 edge).</p></div></div><div class="top"><p class="src"><a id="v:button_stop_high_edge" class="def">button_stop_high_edge</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:button_stop_high_edge" class="selflink">#</a></p><div class="doc"><p>Like <code><a href="Controls.html#v:button_start_high_edge" title="Controls">button_start_high_edge</a></code> but for the stop button.</p></div></div><div class="top"><p class="src"><a id="v:error_controls" class="def">error_controls</a> :: <a href="Controls.html#t:Controls" title="Controls">Controls</a> -&gt; Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:error_controls" class="selflink">#</a></p><div class="doc"><p>True if there is an error in the control values.
 For instance, a ridiculously high or low volume limit, or a 0 in the
 I:E ratio.</p><p>TODO use an error code.</p></div></div><div class="top"><p class="src"><a id="v:bpm_limited" class="def">bpm_limited</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a> <a href="#v:bpm_limited" class="selflink">#</a></p><div class="doc"><p>Limit the breaths per minute to [6,40]</p><p>FIXME TODO determine whether these are sensible BPM limits.</p></div></div><div class="top"><p class="src"><a id="v:ie_inhale_limited" class="def">ie_inhale_limited</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a> <a href="#v:ie_inhale_limited" class="selflink">#</a></p><div class="doc"><p>The inhale portion of the I:E ratio is constrained by the exhale
 portion, and may not be 0.</p></div></div><div class="top"><p class="src"><a id="v:ie_exhale_limited" class="def">ie_exhale_limited</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a> <a href="#v:ie_exhale_limited" class="selflink">#</a></p><div class="doc"><p>The exhale part of the I:E ratio may be anything other than 0.
 The inhale portion will be constrained by this.</p></div></div><div class="top"><p class="src"><a id="v:volume_limit_limited" class="def">volume_limit_limited</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a> <a href="#v:volume_limit_limited" class="selflink">#</a></p><div class="doc"><p>Limits on the global volume limit. Unit is mL.</p><p>FIXME sensible limits. Currently it's 1L max and 100mL min</p></div></div><div class="top"><p class="src"><a id="v:pressure_limit_limited" class="def">pressure_limit_limited</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a> <a href="#v:pressure_limit_limited" class="selflink">#</a></p><div class="doc"><p>Limits on the global pressure limit. Unit is Pa.</p><p>FIXME sensible limits. Currently it's 5000Pa max and 100Pa min.</p></div></div><div class="top"><p class="src"><a id="v:peep_limited" class="def">peep_limited</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a> <a href="#v:peep_limited" class="selflink">#</a></p><div class="doc"><p>Positive end-expiratory pressure, in pascals.</p><p>Sane values for PEEP? It is relative to ambient pressure, and is positive
 by definition/name, so 0 is the obvious lower bound. The idea is that PEEP
 is always &quot;on&quot; but 0 means no PEEP.</p><p>TODO decide on a sensible upper bound. Apparently 10cmH2O is reasonable.</p><p>TODO use Int32 and guarantee it's positive and within bounds, so that other
 parts of the program do not need to unsafeCast.</p></div></div><div class="top"><p class="src"><a id="v:cmv_mode" class="def">cmv_mode</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:cmv_mode" class="selflink">#</a></p><div class="doc"><p>No sanity checking to do here, just give the control stream.</p></div></div><div class="top"><p class="src"><a id="v:cmvVC" class="def">cmvVC</a> :: <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:cmvVC" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:cmvPC" class="def">cmvPC</a> :: <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:cmvPC" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:cmv_volume_goal_limited" class="def">cmv_volume_goal_limited</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a> <a href="#v:cmv_volume_goal_limited" class="selflink">#</a></p><div class="doc"><p>In milliliters</p><p>One recommendation says that 6-8mL/kg ideal body weight is healthy.
 Since patient weights may vary, we'll allow for anywhere from 40-200kg.
 TODO check this</p><p>Does not use the global limited; those will be checked at all times and used
 to determine alarms.</p></div></div><div class="top"><p class="src"><a id="v:cmv_pressure_goal_limited" class="def">cmv_pressure_goal_limited</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a> <a href="#v:cmv_pressure_goal_limited" class="selflink">#</a></p><div class="doc"><p>Limited to 0-40 cmH2O</p><p>Does not use the global limited; those will be checked at all times and used
 to determine alarms.</p></div></div><div class="top"><p class="src"><a id="v:global_max_flow" class="def">global_max_flow</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a> <a href="#v:global_max_flow" class="selflink">#</a></p><div class="doc"><p>Max safe flow in uL/ms
 90 L/minute
 TODO sensible value?
 This is also limited by hardware of course.</p></div></div><div class="top"><p class="src"><a id="v:global_volume_min" class="def">global_volume_min</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a> <a href="#v:global_volume_min" class="selflink">#</a></p><div class="doc"><p>mL</p></div></div><div class="top"><p class="src"><a id="v:global_volume_max" class="def">global_volume_max</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a> <a href="#v:global_volume_max" class="selflink">#</a></p><div class="doc"><p>mL</p></div></div><div class="top"><p class="src"><a id="v:global_pressure_min" class="def">global_pressure_min</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a> <a href="#v:global_pressure_min" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:global_pressure_max" class="def">global_pressure_max</a> :: Stream <a href="file:///nix/store/0wffxskjn0q9i1jdasgvs4p0pg4krja1-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a> <a href="#v:global_pressure_max" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>